<div class="container">
    <h2>ğŸ’– æˆ‘ä»¬çš„çˆ±æƒ…æ•°æ®å¹´æŠ¥ ğŸ’–</h2>
    <p class="subtitle">ä»2023å¹´8æœˆ18æ—¥åˆ°ç°åœ¨çš„æ¸©æš–ç§¯ç´¯</p>
    
    <!-- ä¸»è¦æ•°æ®å¡ç‰‡ -->
    <div class="stats-grid">
        <div class="stat-card">
            <div class="stat-icon">ğŸ“…</div>
            <div class="stat-content">
                <div class="stat-number" id="days-together">0</div>
                <div class="stat-label">ç›¸ä¼´å¤©æ•°</div>
            </div>
        </div>
        
        <div class="stat-card">
            <div class="stat-icon">ğŸ“</div>
            <div class="stat-content">
                <div class="stat-number" id="total-call-hours">0</div>
                <div class="stat-label">ç´¯è®¡é€šè¯</div>
                <div class="stat-subtext" id="call-minutes">0åˆ†é’Ÿ</div>
            </div>
        </div>
        
        <div class="stat-card">
            <div class="stat-icon">ğŸ“–</div>
            <div class="stat-content">
                <div class="stat-number" id="total-stories">0</div>
                <div class="stat-label">æ•…äº‹æ€»æ•°</div>
                <div class="stat-subtext">çº¦0ä¸ª/å¤©</div>
            </div>
        </div>
    </div>
    
    <!-- å¯è§†åŒ–å›¾è¡¨ -->
    <div class="charts-section">
        <div class="chart-card">
            <h3>ğŸ“Š é€šè¯æ—¶é•¿åˆ†å¸ƒ</h3>
            <div class="chart-container">
                <div class="donut-chart" id="call-chart">
                    <div class="chart-center">
                        <div class="chart-value" id="call-per-day">0</div>
                        <div class="chart-label">åˆ†é’Ÿ/å¤©</div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="chart-card">
            <h3>ğŸ¯ å¹´åº¦ç›®æ ‡è¿›åº¦</h3>
            <div class="progress-charts">
                <div class="mini-progress">
                    <div class="mini-label">é€šè¯ç›®æ ‡</div>
                    <div class="mini-progress-bar">
                        <div class="mini-progress-fill" id="call-goal-progress"></div>
                    </div>
                    <div class="mini-value" id="call-goal-text">0/10000åˆ†é’Ÿ</div>
                </div>
                
                <div class="mini-progress">
                    <div class="mini-label">æ•…äº‹ç›®æ ‡</div>
                    <div class="mini-progress-bar">
                        <div class="mini-progress-fill" id="story-goal-progress"></div>
                    </div>
                    <div class="mini-value" id="story-goal-text">0/365ä¸ª</div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- é‡Œç¨‹ç¢‘æˆå°± -->
    <div class="milestones-section">
        <h3>ğŸ† çˆ±æƒ…é‡Œç¨‹ç¢‘</h3>
        <div class="milestones-grid" id="milestones-container">
            <!-- é‡Œç¨‹ç¢‘å°†ç”±JavaScriptåŠ¨æ€ç”Ÿæˆ -->
        </div>
    </div>
    
    <!-- åˆ†äº«æŒ‰é’® -->
    <div class="share-section">
        <button class="share-btn" id="share-btn">
            <span class="share-icon">ğŸ“¤</span>
            åˆ†äº«æˆ‘ä»¬çš„çˆ±æƒ…æ•°æ®
        </button>
    </div>
</div>

<script>
// å¹´åº¦ç»Ÿè®¡åŠŸèƒ½
(function() {
    console.log('ğŸ“Š åˆå§‹åŒ–å¹´åº¦ç»Ÿè®¡åŠŸèƒ½...');
    
    // é…ç½®æ•°æ® - è¿™é‡Œè®¾ç½®ä½ ä»¬çš„æ€»æ•°æ®
    const loveData = {
        startDate: '2023-08-18', // å¼€å§‹æ—¥æœŸ
        totalCallMinutes: 12800, // æ€»é€šè¯åˆ†é’Ÿæ•° - æ ¹æ®å®é™…æƒ…å†µä¿®æ”¹
        totalStories: 285,       // æ€»è®²æ•…äº‹æ•° - æ ¹æ®å®é™…æƒ…å†µä¿®æ”¹
        goals: {
            callMinutes: 10000,  // å¹´åº¦é€šè¯ç›®æ ‡
            stories: 365         // å¹´åº¦æ•…äº‹ç›®æ ‡
        }
    };

    // åˆå§‹åŒ–
    function initStats() {
        calculateStats();
        updateDisplay();
        setupEventListeners();
        checkMilestones();
        console.log('âœ… å¹´åº¦ç»Ÿè®¡åŠŸèƒ½åˆå§‹åŒ–å®Œæˆ');
    }

    // è®¡ç®—ç»Ÿè®¡æ•°æ®
    function calculateStats() {
        const startDate = new Date(loveData.startDate);
        const today = new Date();
        
        // è®¡ç®—æ€»å¤©æ•°
        const timeDiff = today - startDate;
        loveData.totalDays = Math.floor(timeDiff / (1000 * 60 * 60 * 24)) + 1;
        
        // è®¡ç®—æ—¥å‡æ•°æ®
        loveData.dailyCallMinutes = (loveData.totalCallMinutes / loveData.totalDays).toFixed(1);
        loveData.dailyStories = (loveData.totalStories / loveData.totalDays).toFixed(1);
        
        // è®¡ç®—ç›®æ ‡è¿›åº¦
        loveData.callGoalProgress = (loveData.totalCallMinutes / loveData.goals.callMinutes) * 100;
        loveData.storyGoalProgress = (loveData.totalStories / loveData.goals.stories) * 100;
        
        // è½¬æ¢ä¸ºå°æ—¶
        loveData.totalCallHours = Math.floor(loveData.totalCallMinutes / 60);
        loveData.remainingMinutes = loveData.totalCallMinutes % 60;
    }

    // æ›´æ–°æ˜¾ç¤º
    function updateDisplay() {
        // æ›´æ–°ä¸»è¦æ•°æ®
        document.getElementById('days-together').textContent = loveData.totalDays;
        document.getElementById('total-call-hours').textContent = loveData.totalCallHours;
        document.getElementById('call-minutes').textContent = `${loveData.remainingMinutes}åˆ†é’Ÿ`;
        document.getElementById('total-stories').textContent = loveData.totalStories;
        
        // æ›´æ–°å›¾è¡¨æ•°æ®
        document.getElementById('call-per-day').textContent = loveData.dailyCallMinutes;
        
        // æ›´æ–°è¿›åº¦æ¡
        updateProgressBars();
        
        // æ›´æ–°ç›®æ ‡æ–‡æœ¬
        document.getElementById('call-goal-text').textContent = 
            `${loveData.totalCallMinutes}/${loveData.goals.callMinutes}åˆ†é’Ÿ`;
        document.getElementById('story-goal-text').textContent = 
            `${loveData.totalStories}/${loveData.goals.stories}ä¸ª`;
    }

    // æ›´æ–°è¿›åº¦æ¡
    function updateProgressBars() {
        const callProgress = Math.min(loveData.callGoalProgress, 100);
        const storyProgress = Math.min(loveData.storyGoalProgress, 100);
        
        document.getElementById('call-goal-progress').style.width = callProgress + '%';
        document.getElementById('story-goal-progress').style.width = storyProgress + '%';
        
        // æ›´æ–°ç¯å½¢å›¾
        updateDonutChart('call-chart', callProgress);
    }

    // æ›´æ–°ç¯å½¢å›¾
    function updateDonutChart(chartId, progress) {
        const chart = document.getElementById(chartId);
        const degrees = (progress / 100) * 360;
        
        chart.style.background = `
            conic-gradient(
                #e84393 0deg ${degrees}deg,
                #f0f0f0 ${degrees}deg 360deg
            )
        `;
    }

    // æ£€æŸ¥é‡Œç¨‹ç¢‘
    function checkMilestones() {
        const milestones = [
            {
                achieved: loveData.totalDays >= 100,
                icon: 'ğŸ‰',
                title: 'ç™¾æ—¥ç›¸ä¼´',
                description: 'ä¸€èµ·åº¦è¿‡100ä¸ªæ—¥å¤œ'
            },
            {
                achieved: loveData.totalCallMinutes >= 10000,
                icon: 'ğŸ“',
                title: 'ä¸‡åˆ†é’Ÿé€šè¯',
                description: 'ç´¯è®¡é€šè¯è¶…è¿‡10000åˆ†é’Ÿ'
            },
            {
                achieved: loveData.totalStories >= 100,
                icon: 'ğŸ“–',
                title: 'ç™¾ä¸ªæ•…äº‹',
                description: 'è®²è¿°äº†100ä¸ªç¡å‰æ•…äº‹'
            },
            {
                achieved: loveData.totalDays >= 365,
                icon: 'â­',
                title: 'å‘¨å¹´çºªå¿µ',
                description: 'ç›¸çˆ±ä¸€å‘¨å¹´'
            },
            {
                achieved: loveData.dailyCallMinutes >= 60,
                icon: 'ğŸ’',
                title: 'æ¯æ—¥ä¸€å°æ—¶',
                description: 'å¹³å‡æ¯å¤©é€šè¯è¶…è¿‡1å°æ—¶'
            },
            {
                achieved: loveData.totalCallMinutes >= 20000,
                icon: 'ğŸ†',
                title: 'ä¸¤ä¸‡åˆ†é’Ÿ',
                description: 'ç´¯è®¡é€šè¯è¶…è¿‡20000åˆ†é’Ÿ'
            }
        ];

        displayMilestones(milestones);
    }

    // æ˜¾ç¤ºé‡Œç¨‹ç¢‘
    function displayMilestones(milestones) {
        const container = document.getElementById('milestones-container');
        const achievedMilestones = milestones.filter(m => m.achieved);
        
        if (achievedMilestones.length === 0) {
            container.innerHTML = '<div class="empty-milestone">ç»§ç»­åŠªåŠ›ï¼Œå³å°†è¾¾æˆç¬¬ä¸€ä¸ªé‡Œç¨‹ç¢‘ï¼</div>';
            return;
        }
        
        container.innerHTML = achievedMilestones.map(milestone => `
            <div class="milestone-item">
                <div class="milestone-icon">${milestone.icon}</div>
                <div class="milestone-content">
                    <div class="milestone-title">${milestone.title}</div>
                    <div class="milestone-desc">${milestone.description}</div>
                </div>
            </div>
        `).join('');
    }

    // è®¾ç½®äº‹ä»¶ç›‘å¬
    function setupEventListeners() {
        // åˆ†äº«æŒ‰é’®
        document.getElementById('share-btn').addEventListener('click', shareStats);
        
        // æ•°æ®å¡ç‰‡ç‚¹å‡»åŠ¨ç”»
        document.querySelectorAll('.stat-card').forEach(card => {
            card.addEventListener('click', function() {
                this.classList.add('card-pulse');
                setTimeout(() => {
                    this.classList.remove('card-pulse');
                }, 600);
            });
        });
    }

    // åˆ†äº«åŠŸèƒ½
    function shareStats() {
        const shareText = `ğŸ’– æˆ‘ä»¬çš„çˆ±æƒ…æ•°æ®å¹´æŠ¥ ğŸ’–
        
ç›¸ä¼´å¤©æ•°: ${loveData.totalDays}å¤©
ç´¯è®¡é€šè¯: ${loveData.totalCallHours}å°æ—¶${loveData.remainingMinutes}åˆ†é’Ÿ
æ•…äº‹æ€»æ•°: ${loveData.totalStories}ä¸ª
æ—¥å‡é€šè¯: ${loveData.dailyCallMinutes}åˆ†é’Ÿ/å¤©

ä»2023å¹´8æœˆ18æ—¥åˆ°ç°åœ¨
æ¯ä¸€åˆ†é’Ÿéƒ½æ˜¯çˆ±çš„ç§¯ç´¯ ğŸ’•`;

        if (navigator.share) {
            navigator.share({
                title: 'æˆ‘ä»¬çš„çˆ±æƒ…æ•°æ®å¹´æŠ¥',
                text: shareText
            }).catch(() => {
                copyToClipboard(shareText);
            });
        } else {
            copyToClipboard(shareText);
        }
    }

    // å¤åˆ¶åˆ°å‰ªè´´æ¿
    function copyToClipboard(text) {
        navigator.clipboard.writeText(text).then(() => {
            alert('ğŸ“‹ æ•°æ®å·²å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼å¯ä»¥åˆ†äº«ç»™TAäº†ï½');
        }).catch(() => {
            prompt('è¯·æ‰‹åŠ¨å¤åˆ¶ä»¥ä¸‹å†…å®¹åˆ†äº«ï¼š', text);
        });
    }

    // DOMåŠ è½½å®Œæˆååˆå§‹åŒ–
    document.addEventListener('DOMContentLoaded', initStats);

    console.log('âœ… å¹´åº¦ç»Ÿè®¡åŠŸèƒ½åŠ è½½å®Œæˆ');
})();
</script>